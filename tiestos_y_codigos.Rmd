---
title: "Problemas: Teoría de la Decisión bajo Incertidumbre (Casos Reales)"
author: "Elena Matteo Niccolò"
date: "`r Sys.Date()`"
output: html_document
---

```{r}
source('teoriadecision_funciones_incertidumbre.R')
```

# Niccolò Grillo

### **Problema 1: Tabla** (Niccolò Grillo)

Consideremos un problema de decisión bajo incertidumbre con tres alternativas y tres posibles estados de la naturaleza. Las alternativas son:

-   **d1**: Alternativa 1.
-   **d2**: Alternativa 2.
-   **d3**: Alternativa 3.

Cada alternativa puede tener diferentes resultados según los posibles estados de la naturaleza, que son:

-   **e1**: Estado 1.
-   **e2**: Estado 2.
-   **e3**: Estado 3.

Las ganancias estimadas (en unidades arbitrarias) para cada alternativa, dependiendo del estado de la naturaleza, se muestran en la siguiente tabla de decisión:

|        | e1  | e2  | e3  |
|--------|-----|-----|-----|
| **d1** | 20  | 10  | -5  |
| **d2** | 15  | 12  | 0   |
| **d3** | 8   | 5   | 3   |

Se deben aplicar varios criterios de decisión bajo incertidumbre para determinar la mejor alternativa. Los criterios a utilizar son:

1.  **Criterio de Wald (Pesimista)** en escenarios favorables y desfavorables.
2.  **Criterio Optimista** en escenarios favorables y desfavorables.
3.  **Criterio de Hurwicz** (con α = 0,3) en escenarios favorables y desfavorables.
4.  **Criterio de Savage** en escenarios favorables y desfavorables.
5.  **Criterio de Laplace** en escenarios favorables y desfavorables.

```{r nicgri1}
X <- matrix(c(20, 10, -5, 15, 12, 0, 8, 5, 3), nrow = 3, ncol = 3, byrow = TRUE)
colnames(X) <- c('e1', 'e2', 'e3')
rownames(X) <- c('d1', 'd2', 'd3')

# Aplicamos el criterio de Wald (Pesimista)
# Este criterio busca minimizar la peor pérdida posible
resultado_wald = criterio.Wald(X, favorable = TRUE)
print(resultado_wald)

#Ahora escenario desfavorable
resultado_wald_desfavorable = criterio.Wald(X, favorable = FALSE)
print(resultado_wald_desfavorable)

# Aplicamos el criterio Optimista (Maximax)
# Este criterio selecciona la alternativa con el mejor resultado posible
resultado_optimista = criterio.Optimista(X, favorable = TRUE)
print(resultado_optimista)

#Ahora escenario desfavorable
resultado_optimista_desfavorable = criterio.Optimista(X, favorable = FALSE)
print(resultado_optimista_desfavorable)

# Aplicamos el criterio de Hurwicz
# alfa es el parámetro de optimismo (0.3 en este caso)
resultado_hurwicz = criterio.Hurwicz(X, alfa = 0.3, favorable = TRUE)
print(resultado_hurwicz)

#Ahora escenario desfavorable
resultado_hurwicz_desfavorable = criterio.Hurwicz(X, alfa = 0.3, favorable = FALSE)
print(resultado_hurwicz_desfavorable)

# Aplicamos el criterio de Savage (minimización del arrepentimiento)
# Este criterio minimiza el arrepentimiento por no haber elegido la mejor opción
resultado_savage = criterio.Savage(X, favorable = TRUE)
print(resultado_savage)

#Ahora escenario desfavorable
resultado_savage_desfavorable = criterio.Savage(X, favorable = FALSE)
print(resultado_savage_desfavorable)

# Aplicamos el criterio de Laplace (asume que todos los estados son igualmente probables)
resultado_laplace = criterio.Laplace(X, favorable = TRUE)
print(resultado_laplace)

#Ahora escenario desfavorable
resultado_laplace_desfavorable = criterio.Laplace(X, favorable = FALSE)
print(resultado_laplace_desfavorable)

# Aplicamos el criterio del Punto Ideal (selecciona la alternativa más cercana al punto ideal)
resultado_puntoideal = criterio.PuntoIdeal(X, favorable = TRUE)
print(resultado_puntoideal)

#Ahora escenario desfavorable
resultado_puntoideal_desfavorable = criterio.PuntoIdeal(X, favorable = FALSE)
print(resultado_puntoideal_desfavorable)

```

Los resultados muestran que, al aplicar los distintos criterios de decisión a la matriz, las alternativas **d2** y **d3** destacan como las opciones óptimas en la mayoría de los casos. En el escenario favorable, **d2** es frecuentemente la mejor elección, mientras que en el desfavorable, **d3** suele ser la más recomendable. **Conclusión**: Las alternativas **d2** y **d3** son las más apropiadas según varios criterios y escenarios, sugiriendo que son decisiones robustas frente a diferentes condiciones.

### Problema 2: Una tienda electronica (Niccolò Grillo)

Una tienda de electrónica está decidiendo cuántas unidades de un nuevo dispositivo (una GPU) debe ordenar para la temporada de ventas navideñas. La demanda del producto es incierta y depende de diferentes factores externos, como las tendencias tecnológicas y el poder adquisitivo de los clientes durante ese período.

Las alternativas disponibles son:

-   **d1**: Ordenar 500 unidades.
-   **d2**: Ordenar 1000 unidades.
-   **d3**: Ordenar 1500 unidades.
-   **d4**: Ordenar 2000 unidades.

Los posibles estados de la naturaleza que podrían influir en la demanda son:

-   **e1**: Demanda muy alta.
-   **e2**: Demanda alta.
-   **e3**: Demanda media.
-   **e4**: Demanda baja.

Las ganancias estimadas (en miles de euros) para cada alternativa, dependiendo del estado de la naturaleza, se muestran en la siguiente tabla de decisión:

```{r NG1}
# Definir la tabla de decisión con los valores del caso real
X <- matrix(c(250, 200, 100, 10, 
              400, 300, 150, -20, 
              500, 350, 200, -50, 
              600, 400, 250, -100),
            nrow = 4, ncol = 4, byrow = TRUE)

colnames(X) <- c('e1', 'e2', 'e3', 'e4')
rownames(X) <- c('d1', 'd2', 'd3', 'd4')

# Mostrar la tabla de decisión
print(X)
```

La tienda desea aplicar diferentes criterios de decisión bajo incertidumbre para determinar la mejor alternativa a seguir. Para ello, se evaluarán todos los métodos de decisión bajo incertidumbre.

```{r NG2}
source('teoriadecision_funciones_incertidumbre.R') 
# Aquí se cargan las funciones necesarias.

# Aplicar todos los criterios de decisión bajo incertidumbre
resultado_todos <- criterio.Todos(X, alfa = 0.3, favorable = TRUE)

# Imprimir la tabla con los resultados de todos los criterios
print(resultado_todos)
```

Basado en los resultados obtenidos, la alternativa d4 parece ser la mejor opción en la mayoría de los métodos evaluados. En el criterio de Wald (Pesimista), Optimista, y Punto Ideal, d4 es la alternativa óptima. Aunque en el criterio de Hurwicz y Laplace se destacan otras alternativas, d4 tiene un buen rendimiento general y es la recomendación más consistente.

# Matteo Conte

### **Problema 1: Tabla**

|     | d1  | d2  | d3  | d4  |
|-----|-----|-----|-----|-----|
| e1  | 3   | 25  | 2   | 18  |
| e2  | 23  | 35  | 28  | 9   |
| e3  | 39  | 7   | 7   | 32  |

```{r Matteo-Conte1}
vec<-c(3,25,2,18,23,35,28,9,39,7,7,32)
X<-crea.tablaX(X,3,4)

#Wald
criterio.Wald(X)
#alternativa 2

criterio.Wald(X,favorable=F)
#alternaitva 1


#Optimista
criterio.Optimista(X)
#alternativa 3

criterio.Optimista(X,favorable = F)
#alternativa 1


#Hurwicz
dibuja.criterio.Hurwicz(X)
dibuja.criterio.Hurwicz_Intervalos(X)
#si alfa<1/3: alternativa 2
#si alfa>1/3: alternativa 3

dibuja.criterio.Hurwicz(X,favorable = F)
#alternativa 1 por cada alfa in (0,1)


#Savage
criterio.Savage(X)
#alternativa 2

criterio.Savage(X,favorable = F)
#alternativa 1


#Laplace
criterio.Laplace(X)
#alternativa 2

criterio.Laplace(X,favorable = F)
#alternativa 1


#Punto_Ideal
criterio.PuntoIdeal(X)
#alternativa 2

criterio.PuntoIdeal(X,favorable = F)
#alternativa 1
```

### **Problema 2: Estrategia para un Plan de Expansión Empresarial**(Matteo Conte)

Una cadena de restaurantes está planificando la expansión en tres nuevas ciudades. Las opciones son:

-   **Ciudad A**: Una gran metrópoli con alta demanda pero también con alta competencia.
-   **Ciudad B**: Una ciudad de tamaño mediano con menor competencia.
-   **Ciudad C**: Una ciudad pequeña con bajos costos operativos, pero con una demanda potencialmente reducida.

El éxito de la expansión depende de cómo los consumidores respondan a la apertura del restaurante, lo que puede ser: - **Alta demanda**: Muchos consumidores y alta rentabilidad. - **Demanda media**: Demanda estable y beneficios moderados. - **Baja demanda**: Baja afluencia de clientes y beneficios limitados.

### **Tabla de Decisión (Beneficios estimados en miles de euros)**

| Ciudad       | Alta demanda (k€) | Demanda media (k€) | Baja demanda (k€) |
|--------------|-------------------|--------------------|-------------------|
| **Ciudad A** | 600               | 400                | 100               |
| **Ciudad B** | 900               | 600                | 200               |
| **Ciudad C** | 1200              | 700                | 50                |

```{r Matteo-Conte2}
vec2<-c(600,400,100,900,600,200,1200,700,50)#valores en k€
X2<-crea.tablaX(vec2,3,3)

criterio.Todos(X2)
#alternativa 2 si resolvendo con Wald
#alternativa 3 si resolvendo con Optimista, Savage, Laplace o Ideal
dibuja.criterio.Hurwicz_Intervalos(X2)
#si alfa<1/3: alternativa 2
#si alfa>1/3: alternativa 3
```

# Elena Inés Palomino Galiana.

### Problema 1: Aplicar los criterios de decisión bajo incertidumbre al problema cuya matriz de valores numéricos viene dadas en la tabla siguiente:

```{r}
tabla1=crea.tablaX(c(2,3,-2,
                     2,-1,1,
                     -1,3,1),numalternativas=3,numestados=3)
tabla1
```

Vamos a resolverlo utilizando los métodos tanto en situación favorable como desfavorable.

```{r}
source("teoriadecision_funciones_incertidumbre.R")

#Criterio de Wald
p1_pesF = criterio.Wald(tabla1,T)
names(p1_pesF$AlternativaOptima) #Las alternativas optimas son d2 y d3
p1_pesD = criterio.Wald(tabla1,F)
names(p1_pesD$AlternativaOptima) #La alternativa optima es d2

#Criterio Optimista
p1_optF = criterio.Optimista(tabla1,T)
names(p1_optF$AlternativaOptima) #Las alternativas optimas son d1 y d3
p1_optD = criterio.Optimista(tabla1,F)
names(p1_optD$AlternativaOptima) ##La alternativa optima es d1

#Criterio de Hurwicz
p1_hurF = criterio.Hurwicz(tabla1,alfa=0.4,T)
names(p1_hurF$AlternativaOptima) #La alternativa optima es d3
p1_hurD = criterio.Hurwicz(tabla1,alfa=0.4,F)
names(p1_hurD$AlternativaOptima) #La alternativa optima es d2

#Criterio de Savage
p1_savF = criterio.Savage(tabla1,T)
names(p1_savF$AlternativaOptima) #Las alternativas optimas son d1 y d3
p1_savD = criterio.Savage(tabla1,F)
names(p1_savD$AlternativaOptima) #La alternativa optima es d2

#Criterio de Laplace
p1_lapF = criterio.Laplace(tabla1,T)
names(p1_lapF$AlternativaOptima) #Las alternativas optimas son d1 y d3
p1_lapF$ValorAlternativas
p1_lapD = criterio.Laplace(tabla1,F)
names(p1_lapD$AlternativaOptima) #La alternativa optima es d2

#Criterio de Punto Ideal
p1_pidF = criterio.PuntoIdeal(tabla1,T)
names(p1_pidF$AlternativaOptima) #Las alternativas optimas son d1 y d3
p1_pidF$ValorAlternativas
p1_pidD = criterio.PuntoIdeal(tabla1,F)
names(p1_pidD$AlternativaOptima) #La alternativa optima es d2

```
Concluimos en situación favorable que la alternativa óptima es d3, debido a que sale como mejor opción en todos los criterios aplicados, a pesar de que la alternativa d1 también sale en muchos de ellos. Mientras que en situación pesimista la alternativa óptima es d2.

### Problema 2: Inés busca trabajo en una ciudad nueva, para ello está buscando piso y ha encontrado dos opciones que se ajustan a sus necesidades, una de ellas se encuentra a 5 minutos andando del trabajo y la otra a 1 hora en autobus. Su sueldo si consigue el trabajo sería de 1500€ al mes, si elige vivir cerca no tendrá gastos en transporte ni en comer fuera pero el alquiler supondría el 40% de su sueldo, mientras que si escoge vivir lejos deberá gastar el 5% en transporte, el 20% en comida y el 25% en alquiler. ¿Qué decisión tomará Inés si no sabe si conseguirá el trabajo?

Trasladamos lo datos obtenidos a una tabla en la que tenemos dos alternativas (d1=vivir cerca, d2=vivir lejos) y 2 estados de la naturaleza (e1=si consigue el trabajo, e2=si no lo consigue).

```{r}
source("teoriadecision_funciones_incertidumbre.R")

m11 = 1500 - (1500*0 + 1500*0.4 + 1500*0)
m12 = 0 - (1500*0 + 1500*0.4 + 1500*0)
m21 = 1500 - (1500*0.05 + 1500*0.25 + 1500*0.2)
m22 = 0 - (1500*0 + 1500*0.25 + 1500*0) #No haría gasto en transporte y comida porque no va a tener que desplazarse si no consigue el empleo.


tabla2=crea.tablaX(c(m11,m12,
                   m21,m22),numalternativas=2,numestados=2)
tabla2
```
